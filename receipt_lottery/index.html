<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title></title>
</head>
<body>
	<div>
		<h4 id="invoice-period"></h4>
	</div>
	<div>
		<input type="text" id="input" maxlength="3" autofocus />
		<button class="sumbit-btn">Check</button>
	</div>
	<div>
		<p id="status"></p>
	</div>
	<div>
		<p>3-Digits List:</p>
		<div id="digits-list-block">
			<!-- <li>123</li> -->
		</div>
	</div>
	<div>
		<p>Matched List: <span class="counter"></span></p>
		<div id="matched-list-block">
			<!-- <li>123</li> -->
		</div>
	</div>


	<script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
	<script type="text/javascript">

		/* Invoice Period */
		var invoicePeriod = "105年11,12月";

		/* 3-Digits Number of Receipt Lottery */
		var digitsList = [
			"003",
			"074",
			"177",
			"760",
			"048",
			"000",
			"059",
			"478",
			"569"
			];
		
		$(function() {

			$("#invoice-period").html(invoicePeriod);

			var lotteryApp = new LotteryApp({
				'digitsList': digitsList,
			});

			lotteryApp.renderDigitsListBlock();
			
			$(".sumbit-btn").click(function() {
				
				lotteryApp.check();
			});

			$( "#input" ).keypress(function( event ) {

				// alert(event.which);

			  	if ( event.which == 13 ) 
			  		lotteryApp.check();
			});
		});

		function LotteryApp(o) {

			'use strict';
			
			var self = this;

			o = o || {};

			self.digitsList = o.digitsList || [];
			var $input = $("#input");
			var $digitsListBlock = $("#digits-list-block");
			var $status = $("#status");
			var $matchedListBlock = $("#matched-list-block");
			var $counter = $(".counter");

			var counter = 0;

			self.init = function () {
				
				// alert("init");
			}

			self.check = function () {
				
				// console.log(self.digitsList);
				// alert($input.val());

				var input = $input.val();

				/* Check is numeric */
				if (isNaN(input)) {

					alert("Please input numeric only");
					return false;
				}

				/* Check length */
				if (input.length != 3) {

					alert("Please input 3 digitals format");
					return false;
				}

				/* Match */
				var result = $.inArray($input.val(), self.digitsList);

				if (result!==-1) {

					alert("Win! "+input);

				} else {

				}

				var datetime = new Date();
				// console.log(datetime);

				/* Template */
				$status.html("Match "+input+" at "+datetime);

				var winSting = result!==-1 ? " - Win" : "";
				$matchedListBlock.prepend("<li>"+input+winSting+"</li>");

				$input.val("");

				/* Counter */
				counter++;
				$counter.html(counter);
			}

			self.renderDigitsListBlock = function () {
				
				digitsList.forEach(function (item) {

					$digitsListBlock.append("<li>"+item+"</li>");
				});
			}

			self.init();
		}

	</script>
</body>
</html>